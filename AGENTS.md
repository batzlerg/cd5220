# Project Agents.md Guide for OpenAI Codex

This Agents.md file provides comprehensive guidance for OpenAI Codex and other AI agents working with this codebase.

## Project Structure for OpenAI Codex Navigation

- `/cd5220.py`: Main display controller that OpenAI Codex should analyze for core functionality
  - `CD5220` class: Primary interface that Agents.md helps OpenAI Codex understand
  - `DisplaySimulator` class: Hardware-free testing model where OpenAI Codex can verify behavior
  - `DiffAnimator` class: Animation engine that Agents.md documents for OpenAI Codex
- `/animations.py`: Animation library functions that OpenAI Codex should extend consistently
  - Individual animation functions that Agents.md requires OpenAI Codex to test deterministically
  - `ASCIIAnimations` wrapper class where OpenAI Codex can add new animation methods
- `/tests`: Test files that OpenAI Codex should maintain and extend with comprehensive coverage
  - `cd5220_simulator.py`: Integration tests that Agents.md requires for simulator accuracy
  - `test_ascii_animations.py`: Animation tests where OpenAI Codex must ensure deterministic behavior
  - `test_cd5220_unit.py`: Unit tests that OpenAI Codex should expand for new features
- `/demo.py`: Demonstration script (OpenAI Codex should not modify core demo patterns)
- `/demo_animations.py`: Animation demo runner (OpenAI Codex should not modify)

## Coding Conventions for OpenAI Codex

### General Conventions for Agents.md Implementation

- Use Python 3.7+ for all new code generated by OpenAI Codex
- OpenAI Codex should follow PEP 8 style guidelines in existing code
- Agents.md requires type hints for all function parameters in OpenAI Codex output
- OpenAI Codex should add docstrings for all public methods as guided by Agents.md
- All user-facing coordinates (API calls and simulator helpers) use **1-based**
  indexing. The simulator stores data internally with 0-based arrays but its
  public methods should always accept 1-based positions.

### Display Mode Guidelines for OpenAI Codex

- OpenAI Codex should use `CD5220.create_simulator_only()` for all automated testing as specified in Agents.md
- Keep mode transitions explicit in code generated by OpenAI Codex
- Agents.md requires proper mode state validation in all OpenAI Codex display operations
- OpenAI Codex must handle `auto_clear_mode_transitions` behavior correctly

### Animation Standards for OpenAI Codex

- OpenAI Codex should use `DiffAnimator` with disabled sleep functions for testing as documented in Agents.md
- Follow frame-by-frame deterministic patterns in all OpenAI Codex animation implementations
- OpenAI Codex should use `random.seed()` for reproducible animation testing

## Testing Requirements for OpenAI Codex

**Important**: Always activate the virtual environment before running
any test or coverage command.

OpenAI Codex should run tests with the following commands:

```bash
# Always activate the virtual environment before running tests
source ./venv/bin/activate

# Run all tests with OpenAI Codex
python -m pytest tests/ -v

# Run specific test file with OpenAI Codex
python -m pytest tests/cd5220_simulator.py -v

# Run tests with coverage for OpenAI Codex code
python -m pytest tests/ -v --cov=cd5220 --cov=animations --cov-report=html

# pytest-cov>=4.0 must be installed for coverage commands to work
```

### Critical Testing Patterns for OpenAI Codex

- OpenAI Codex must test all mode transitions and restrictions as guided by Agents.md
- Use simulator assertions: `sim.assert_char_at()`, `sim.assert_line_equals()`, `sim.assert_region_equals()`
- OpenAI Codex should test parameter validation for all boundary conditions
- Agents.md requires property-based testing with hypothesis for edge cases

## Pull Request Guidelines for OpenAI Codex

When OpenAI Codex helps create a PR, please ensure it:

1. Includes comprehensive test coverage for all new functionality as guided by Agents.md
2. Maintains simulator accuracy with hardware behavior for code generated by OpenAI Codex
3. Ensures all mode state transitions work correctly as specified in Agents.md
4. Includes deterministic animation tests for any new animations implemented with OpenAI Codex
5. Keeps PRs focused on single features while maintaining hardware-free testing as required by Agents.md

## Programmatic Checks for OpenAI Codex

Before submitting changes generated by OpenAI Codex, run:

```bash
# Test suite for OpenAI Codex code
python -m pytest tests/ -v --cov=cd5220 --cov=animations

# Simulator validation for OpenAI Codex implementations
python -m pytest tests/cd5220_simulator.py -v

# Animation testing for OpenAI Codex animations
python -m pytest tests/test_ascii_animations.py -v
```

All tests must pass with minimum 95% line coverage before OpenAI Codex generated code can be merged. Agents.md helps ensure OpenAI Codex follows these requirements.

### Hardware-Free Testing Requirements for OpenAI Codex

- OpenAI Codex must use `display = CD5220.create_simulator_only()` for all automated tests
- Never assume hardware availability in OpenAI Codex generated test code
- Use `sleep_fn=lambda _: None` and `frame_sleep_fn=lambda _: None` for animation testing
- Agents.md requires simulator state assertions over hardware assumptions in all OpenAI Codex code
---
